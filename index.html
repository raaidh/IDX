<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ID Name Extractor</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    .result { margin-top: 20px; white-space: pre-wrap; }
    .preview { max-height: 150px; margin-top: 10px; }
  </style>
</head>
<body>

<h2>ID Card Name Extractor</h2>
<input type="file" id="imageUpload" accept="image/*" multiple><br><br>
<button onclick="processImages()">Extract Names</button>

<div class="result" id="output"></div>

<script>
  async function processImages() {
    const files = document.getElementById('imageUpload').files;
    const outputDiv = document.getElementById('output');
    outputDiv.innerHTML = "Processing...";

    const results = [];

    for (const file of files) {
      const image = await readFile(file);
      const result = await Tesseract.recognize(image, 'eng');
      const text = result.data.text;

      // Extract name
      const fullName = extractLine(text, "Name");
      const commonName = extractLine(text, "Common Name");

      results.push({
        file: file.name,
        full_name: fullName,
        common_name: commonName
      });
    }

    // Display results
    outputDiv.innerHTML = results.map(r =>
      `File: ${r.file}\nFull Name: ${r.full_name}\nCommon Name: ${r.common_name || 'N/A'}\n\n`
    ).join('');
  }

  function extractLine(text, label) {
    const regex = new RegExp(label + "\\s*:?\\s*(.+)", "i");
    const lines = text.split('\n');
    for (let line of lines) {
      const match = line.match(regex);
      if (match) return match[1].trim();
    }
    return null;
  }

  function readFile(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = e => resolve(e.target.result);
      reader.onerror = e => reject(e);
      reader.readAsDataURL(file);
    });
  }
</script>

</body>
</html>
